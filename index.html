<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>BuildCV - Free Online CV Builder India | ATS Friendly Templates</title>
  <meta name="description"
  content="BuildCV lets you create a professional, eye-catching CV in minutes. Free, fast, and ATS-friendly templates designed for Indian job seekers.">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="icon" type="image/x-icon" href="./images/favicon.ico">
  <link rel="stylesheet" href="./style/jsonToHtml.css">
  <link rel="stylesheet" href="./style/bcv.css">
  <style>
    .emailContact {
      background: rgba(255, 255, 255, 0.3);
      margin: 10px;
      font-size: 16px;
      font-weight: 600;
    }
  </style>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <nav class="navbar navbar-default" style="margin-bottom: 5px;">
    <div class="container-fluid">
      <div class="navbar-header active">
        <a class="navbar-brand" href="#" style="background-color: #dff3f5;" onclick="showHidePage('bcvHome')">Build
          CV</a>
        <!-- <img src="./images/build-your-cv-logo.svg" class="navbar-brand" /> -->
      </div>
      <ul class="nav navbar-nav">
        <li><a href="#" onclick="showHidePage('bcvHome')">Home</a></li>
        <li><a href="#" onclick="showHidePage('gmcvDiv')">Gey My CV</a></li>
        <li><a href="#" onclick="showHidePage('bcvWithJSON')">Build CV Using JSON</a></li>
        <li class="dropdown">
          <a href="#">Interview Preparation &#9662;</a> <!-- â–¼ symbol -->
          <ul class="dropdown-menu">
            <li><a href="https://www.buildcv.co.in/quiz" target="_blank">React & Beyond Quiz</a></li>
            <li><a href="#" onclick="alert('Coming Soon !!')">Java</a></li>
          </ul>
        </li>
        <li><a href="https://www.buildcv.co.in/javascript-compiler" target="_blank">JavaScript Online Compiler</a></li>
        <li><a href="#" onclick="showHidePage('bcvAbout')">About</a></li>
      </ul>
      <div class="emailContact contact">
        <a href="mailto:contact@buildcv.co.in">ðŸ“§buildcv.co.in@zohomail.in</a>
      </div>
    </div>
  </nav>
  <div id='bcvWithJSON' style="display: none;">
    <div class="container" style="width: auto; max-width: unset;">
      <div class="panel">
        <h3>JSON Editor</h3>
        <div class="toolbar">
          <button class="btn" id="btnRender">Render Resume</button>
          <button class="btn gray" id="btnFormat">Prettify</button>
          <button class="btn gray" id="btnMinify">Minify</button>
          <button class="btn secondary" id="btnDownload">Download JSON</button>
          <label class="btn gray small" for="fileInput" style="cursor:pointer">Upload JSON</label>
          <input type="file" id="fileInput" accept="application/json,text/json">
          <button class="btn gray" id="btnReset">Reset to Sample</button>
        </div>
        <div id="error" class="error" role="alert" aria-live="polite"></div>
        <textarea id="jsonEditor" spellcheck="false"></textarea>
      </div>

      <div class="panel">
        <h3>Preview Generated From JSON</h3>
        <!-- <button id="btnPrintPreview" class="btn">Export / Print</button> &nbsp;&nbsp; -->
        <button id="downloadPDFBtnJSONCV" onclick="generatePDF('jsonPreview')" class="btn secondary">Download PDF</button>&nbsp;&nbsp;
        <button id="btnGetCVUrl" onclick="openPopup()" class="btn"
          title="Create your own shareable CV link. It can be accessed anywhere.">Get Your Own Live CV URL</button>
        <div class="jsonPreview" id="jsonPreview">
          <!-- Rendered resume appears here -->
        </div>
      </div>
    </div>
  </div>
  <div class="popup-overlay" id="popupOverlay">
    <div class="popup">
      <h2>Hello ðŸ‘‹</h2>
      <p>Email your JSON file to <b>buildcv.co.in@zohomail.in</b>.<br /> You will get your live link within 24 hours, like
        below.</p>
      <a href="https://www.buildcv.co.in/profile.html?user=abhishek"
        target="_blank">https://www.buildcv.co.in/profile.html?user=abhishek</a><br />
      <button onclick="closePopup()">Close</button>
    </div>
  </div>

  <div id="bcvAbout" style="display: none; margin-left: 5rem;">
    <p><strong>www.buildcv.co.in</strong> is your fast, free, and powerful online CV builder. With a range of
      beautifully designed, ATS-friendly templates, our platform helps you:</p>

    <ul>
      <li><strong>Create professional, eye-catching resumes quickly</strong> â€” no formatting hassle required.</li>
      <li><strong>Leverage smart tools to guide your content</strong> â€” our intuitive interface ensures clarity and
        relevance.</li>
      <li><strong>Download your CV instantly as a polished PDF</strong> â€” ready to apply for jobs right away.</li>
      <li><strong>Save time and reduce stress</strong> â€” focus on your experiences, not the layout.</li>
      <li style="color: #009999;"><strong>Generate a live CV link</strong> â€” share your resume online with a single URL,
        no need for attachments.</li>
    </ul>

    <p>
      Whether you're a recent graduate, a mid-career professional, or looking to shift industries,
      <strong>buildcv.co.in</strong> equips you with a standout resume that gets noticed.
    </p>
  </div>

  <div class="gmcvContainer" id="gmcvDiv" style="display: none;">
    <iframe src="./images/myCV.pdf" style="width:100%; height:100vh;" frameborder="0"></iframe>
  </div>
  <div class="app" id="bcvHome" style="padding-top: 0;">
    <div class="card controls">
      <h2>Build your resume</h2>

      <div class="section">
        <label>Full name</label>
        <input id="fullName" type="text" value="Your Name" />
      </div>

      <div class="section row" style="padding-left: 0px;">
        <div style="flex:1">
          <label>Email</label>
          <input id="email" type="email" placeholder="you@example.com" />
        </div>
        <div style="width:140px">
          <label>Phone</label>
          <input id="phone" type="tel" placeholder="+91 9xxxx" />
        </div>
      </div>

      <div class="section">
        <label>Professional title</label>
        <input id="title" type="text" placeholder="Frontend Developer" />
      </div>

      <div class="section">
        <label>Summary<span style="font-weight: 600;"> (spaces, tabs, and line breaks are preserved exactly as written)</span></label>
        <textarea id="summary" placeholder="Short professional summary"></textarea>
      </div>

      <div class="section">
        <label>Skills (comma separated)</label>
        <input id="skills" type="text" placeholder="React, JavaScript, SQL" />
      </div>

      <div class="section">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0;font-size:15px">Experience</h3>
          <button id="addExp" class="btn small">+ Add</button>
        </div>
        <div id="expList" class="list"></div>
      </div>

      <div class="section">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0;font-size:15px">Education</h3>
          <button id="addEdu" class="btn small">+ Add</button>
        </div>
        <div id="eduList" class="list"></div>
      </div>
      <div class="section">
        <label>Languages (comma separated)</label>
        <input id="languages" type="text" placeholder="English, Hindi, Telgu" />
      </div>
      <div class="section">
        <label>Personal Information</label>
        <input id="personalInfo" type="text" placeholder="Date of Birth (DD-MM-YYYY)" />
      </div>

      <div class="section row">
        <button id="updateBtn" class="btn">Update Preview</button>
        <button id="downloadJson" class="btn secondary">Download JSON</button>
      </div>

      <div class="section row" style="margin-top:12px">
        <button id="printBtn" class="btn">Export / Print</button>
        <button id="resetBtn" class="btn secondary">Reset</button>
      </div>

      <p class="muted" style="margin-top:12px">Tip: Click "Add" to create multiple experience or education entries. Use
        Export/Print to save as PDF.</p>
    </div>
    <div class="preview-wrap" style="padding-top: 0px;">
      <div id="colorPreview" class="center-block" style="background-color: #009999;"></div>
      <div class="color-box">
        <span class="fw-bold">ðŸŽ¨ Choose CV Theme Color</span>
        <input type="color" id="colorPicker" value="#009999" class="form-control"
          style="width:60px; padding:0; border:none;">
        <span id="colorCode" class="label label-primary">#009999</span>
        <button id="downloadPDFBtn" onclick="generatePDF()" class="btn secondary">Download PDF</button>
        <button onclick="openPopup()" class="btn" title="Create your own shareable CV link. It can be accessed anywhere.">Get Your Own Live CV URL</button>
      </div>

      <div class="card preview" id="preview">
        <!-- Preview content injected by JS -->
      </div>
    </div>
  </div>

  <template id="expTpl">
    <div class="item">
      <div class="meta">
        <input class="exp-role" type="text" placeholder="Role / Title" style="flex:2" />
        <input class="exp-company" type="text" placeholder="Company" style="flex:1" />
      </div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <input class="exp-from" type="text" placeholder="From (e.g. 2021)" />
        <input class="exp-to" type="text" placeholder="To (e.g. Present)" />
      </div>
      <textarea class="exp-desc" placeholder="Short description"></textarea>
      <div style="text-align:right;margin-top:6px">
        <button class="removeExp btn secondary small">Remove</button>
      </div>
    </div>
  </template>

  <template id="eduTpl">
    <div class="item">
      <div style="display:flex;gap:8px;align-items:center">
        <input class="edu-degree" type="text" placeholder="Degree / Course" style="flex:1" />
        <input class="edu-school" type="text" placeholder="Institute" style="flex:1" />
      </div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <input class="edu-year" type="text" placeholder="Year" />
        <input class="edu-grade" type="text" placeholder="Grade / CGPA" />
      </div>
      <div style="text-align:right;margin-top:6px">
        <button class="removeEdu btn secondary small">Remove</button>
      </div>
    </div>
  </template>

  <script>
    // Utility helpers
    const qs = s => document.querySelector(s);
    const qsa = s => document.querySelectorAll(s);

    const fullName = qs('#fullName');
    const email = qs('#email');
    const phone = qs('#phone');
    const title = qs('#title');
    const summary = qs('#summary');
    const skills = qs('#skills');
    const expList = qs('#expList');
    const eduList = qs('#eduList');
    const addExp = qs('#addExp');
    const addEdu = qs('#addEdu');
    const languages = qs('#languages');
    const personalInfo = qs('#personalInfo');
    const updateBtn = qs('#updateBtn');
    const preview = qs('#preview');
    const printBtn = qs('#printBtn');
    const resetBtn = qs('#resetBtn');
    const downloadJson = qs('#downloadJson');

    function createFromTemplate(tplId) {
      const tpl = document.getElementById(tplId);
      return tpl.content.firstElementChild.cloneNode(true);
    }

    function addExperience(data) {
      const node = createFromTemplate('expTpl');
      if (data) {
        node.querySelector('.exp-role').value = data.role || '';
        node.querySelector('.exp-company').value = data.company || '';
        node.querySelector('.exp-from').value = data.from || '';
        node.querySelector('.exp-to').value = data.to || '';
        node.querySelector('.exp-desc').value = data.desc || '';
      }
      node.querySelector('.removeExp').addEventListener('click', () => node.remove());
      expList.appendChild(node);
    }
    function addEducation(data) {
      const node = createFromTemplate('eduTpl');
      if (data) {
        node.querySelector('.edu-degree').value = data.degree || '';
        node.querySelector('.edu-school').value = data.school || '';
        node.querySelector('.edu-year').value = data.year || '';
        node.querySelector('.edu-grade').value = data.grade || '';
      }
      node.querySelector('.removeEdu').addEventListener('click', () => node.remove());
      eduList.appendChild(node);
    }

    // initial sample
    addExperience({ role: 'Frontend Developer', company: 'Acme Corp', from: '2021', to: 'Present', desc: 'Built UI components using React and improved performance.' });
    addEducation({ degree: 'B.Tech Computer Science', school: 'State University', year: '2017', grade: '7.8 CGPA' });

    function collectData() {
      const exps = Array.from(expList.children).map(item => ({
        role: item.querySelector('.exp-role').value,
        company: item.querySelector('.exp-company').value,
        from: item.querySelector('.exp-from').value,
        to: item.querySelector('.exp-to').value,
        desc: item.querySelector('.exp-desc').value
      }));
      const edus = Array.from(eduList.children).map(item => ({
        degree: item.querySelector('.edu-degree').value,
        school: item.querySelector('.edu-school').value,
        year: item.querySelector('.edu-year').value,
        grade: item.querySelector('.edu-grade').value
      }));

      return {
        name: fullName.value,
        title: title.value,
        email: email.value,
        phone: phone.value,
        summary: summary.value,
        skills: skills.value.split(',').map(s => s.trim()).filter(Boolean),
        experience: exps,
        education: edus,
        languages: languages.value.split(',').map(s => s.trim()).filter(Boolean),
        personalInformation: personalInfo.value
      };
    }

    function getCVThemeColor() {
      return document.getElementById("colorPreview").style.backgroundColor;
    }

    function applyTagStyle(className) {
      let elements = document.getElementsByClassName(className);
      Array.from(elements).map(element => {
        element.style.display = "inline-block";
        element.style.padding = "6px 8px";
        element.style.borderRadius = "999px";
        element.style.border = "1px solid #e6e9ef";
        element.style.margin = "4px 6px 4px 0";
        element.style.fontSize = "13px";
      });
    }

    function renderPreview() {
      const d = collectData();
      preview.innerHTML = `
        <div class="resume-head">
          <div>
            <div class="name" style="color: ${getCVThemeColor()}">${escapeHtml(d.name || '')}</div>
            <div style="font-weight:600;color:#111">${escapeHtml(d.title || '')}</div>
          </div>
          <div style="text-align:right">
            <div class="contact">${escapeHtml(d.email || '')}</div>
            <div class="contact">${escapeHtml(d.phone || '')}</div>
          </div>
        </div>
        <div>
          <div class="section-title" style="font-weight: 600; color: ${getCVThemeColor()}">Summary</div>
          <div style="margin-bottom:8px; white-space: pre-wrap;">${escapeHtml(d.summary || '')}</div><br/>

          <div class="section-title" style="font-weight: 600; color: ${getCVThemeColor()}">Skills</div>
          <div>${d.skills.map(s => `<span class="skill-pill">${escapeHtml(s)}</span>`).join('')}</div><br/>

          <div class="section-title" style="font-weight: 600; color: ${getCVThemeColor()}">Experience</div>
          ${d.experience.map(e => `
            <div style="margin-bottom:10px">
              <div style="font-weight:700">${escapeHtml(e.role)} â€” <span style="font-weight:600;color:var(--muted)">${escapeHtml(e.company)}</span></div>
              <div class="muted" style="font-size:13px;margin-bottom:6px">${escapeHtml(e.from)} â€” ${escapeHtml(e.to)}</div>
              <div style="font-size:14px">${escapeHtml(e.desc)}</div>
            </div>
          `).join('')}
          <br/>
          <div class="section-title" style="font-weight: 600; color: ${getCVThemeColor()}">Education</div>
          ${d.education.map(u => `
            <div style="margin-bottom:8px">
              <div style="font-weight:700">${escapeHtml(u.degree)} â€” <span style="font-weight:600;color:var(--muted)">${escapeHtml(u.school)}</span></div>
              <div class="muted" style="font-size:13px">${escapeHtml(u.year)}  ${escapeHtml(u.grade)}</div>
            </div>
          `).join('')}
          <br/>
          <div class="section-title" style="font-weight: 600; color: ${getCVThemeColor()}">Languages</div>
          <div>${d.languages.map(s => `<span class="skill-pill">${escapeHtml(s)}</span>`).join('')}</div><br/>
          <div class="section-title" style="font-weight: 600; color: ${getCVThemeColor()}">Personal Information</div>
          <div>Date of birth: ${escapeHtml(d.personalInformation || '')}</div>
        </div>
      `;
      applyTagStyle('skill-pill');
    }

    function escapeHtml(str) {
      if (!str) return '';
      return String(str).replace(/[&<>"']/g, s => ({
        '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
      })[s]);
    }

    const getPagesList = () => {
      return ['bcvHome', 'gmcvDiv', 'bcvWithJSON', 'bcvAbout'];
    }

    const showHidePage = (thisPageId) => {
      try {
        let thisPage = document.getElementById(thisPageId)
        thisPage.style.display = 'grid';
        // e && e.target && e.target.classList.add('active');
        let allPagesList = getPagesList();
        allPagesList.map((item) => {
          if (item !== thisPageId) {
            document.getElementById(item).style.display = 'none';
          }
        });
      } catch (err) {
        console.error('Exception error', err);
      }
    }

    addExp.addEventListener('click', () => addExperience());
    addEdu.addEventListener('click', () => addEducation());
    updateBtn.addEventListener('click', renderPreview);

    // live update on change (debounced)
    let timer; document.querySelectorAll('input,textarea').forEach(el => el.addEventListener('input', () => { clearTimeout(timer); timer = setTimeout(renderPreview, 300); }));

    printBtn.addEventListener('click', () => {
      // open a new window with only the resume content for printing
      const w = window.open('', '_blank');
      const html = `<!doctype html><html><head><meta charset="utf-8"><title>www.buildcv.co.in</title><link rel="stylesheet" href="./style/jsonToHtml.css"><link rel="stylesheet" href="./style/bcv.css"><style>body{font-family:Inter,Arial;margin:40px;color:#0f172a}.name{font-size:28px;font-weight:700;}.muted{color:#6b7280}</style></head><body>${preview.innerHTML}</body></html>`;
      w.document.write(html); w.document.close();
      w.focus();
      setTimeout(() => { w.print(); }, 300);
    });

    resetBtn.addEventListener('click', () => {
      if (!confirm('Reset all fields?')) return;
      fullName.value = ''; email.value = ''; phone.value = ''; title.value = ''; summary.value = ''; skills.value = '';
      expList.innerHTML = ''; eduList.innerHTML = '';
      renderPreview();
    });

    downloadJson.addEventListener('click', () => {
      let data = collectData();
      data = convertJSON(data);
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = (data.name.first || 'resume').replace(/\s+/g, '_').toLowerCase() + '.json';
      a.click();
      URL.revokeObjectURL(a.href);
    });

    // initial render
    renderPreview();
  </script>
  <script>
    const picker = document.getElementById("colorPicker");
    const cPreview = document.getElementById("colorPreview");
    const code = document.getElementById("colorCode");

    // Set initial color
    cPreview.style.backgroundColor = picker.value;

    // Update preview when user picks a color
    picker.addEventListener("input", function () {
      const color = picker.value;
      cPreview.style.backgroundColor = color;
      code.textContent = color;
    });
  </script>
  <script>
    // Sample resume JSON (initial)
    const sample = {
      "name": { "first": "Abhishek", "last": "Kumar" },
      "contact": { "phone": "+91-9154826149", "email": "abhishek.kumar2025@yahoo.com", "website": "https://www.buildcv.co.in/", "address": { "street": "", "city": "", "state": "", "zip": "" } },
      "summary": [
        "IT Professional with 11 years of experience, including 7+ years in React.js/Redux and 4 years in Micro Frontend (Module Federation). Skilled in building scalable applications, reusable components, and backend solutions with C#, ASP.Net MVC, Web API, SQL.",
        "Strong expertise in JavaScript/TypeScript, KafkaJS, Redis, AngularJS and Agile delivery with Git/SVN, Jenkins, and JIRA, Rally."
      ],
      "career_summary": [
        { "role": "Software Engineer II", "company": "Concentrix Catalyst Technologies Private Limited", "location": "", "duration": "03/2021 to Current", "description": "" },
        { "role": "Principal Software Developer", "company": "Hexagon Capability Centre India", "location": "Hyderabad", "duration": "03/2018 to 03/2021", "description": "" },
        { "role": "Software Engineer", "company": "Rockwell Collins India Pvt Ltd", "location": "Hyderabad", "duration": "02/2016 to 03/2018", "description": "" },
        { "role": "Programmer", "company": "Kantar GDC", "location": "Hyderabad", "duration": "12/2013 to 07/2015", "description": "" }
      ],
      "skills": ["React.JS", "Redux", "JavaScript", "TypeScript", "RxJS", "KafksJS", "Node-redis", "Mediapipe", "TesorFlow.js", "C#", "ASP.NET MVC", "ASP.NET", "ADO.NET", "Entity Framework", "SQL Server", "Oracle", "MySQL", "Visual studio code", "Unit testing", "API integration", "Agile methodologies", "Version control", "Problem solving", "Critical thinking", "Client communication", "Team leadership", "Team player", "Code reviews", "Agile and scrum frameworks", "Machine learning basics"],
      "projects": [
        { "title": "Video Visit", "duration": "Mar 2021 â€“ Present", "technologies": ["React.JS", "JavaScript", "HTML", "CSS"], "client": "Kaiser Permanente", "description": "Developed virtual consultation applications (VVM for patients, VVP for clinicians), enabling video-based doctor appointments.", "responsibilities": ["Developed reusable React components and optimized rendering performance.", "Implemented Redux state management for seamless data flow.", "Integrated video call APIs for real-time virtual consultations.", "Collaborated with doctors and stakeholders to refine UI/UX requirements.", "Conducted unit testing and participated in code reviews for quality assurance."] },
        { "title": "PIM (Product Information Management)", "duration": "Mar 2018 â€“ Mar 2021", "technologies": ["React.JS", "Redux", "JavaScript", "HTML", "CSS", "C#", "Web API", "SQL Server"], "client": "Hexagon", "description": "Designed and implemented scalable PIM solutions, integrating React.js frontend with C# and SQL backend to manage product information efficiently.", "responsibilities": ["Developed micro frontend modules using React.js and Redux.", "Built APIs with C# and Web API to manage product data.", "Worked closely with product teams to define requirements.", "Optimized SQL queries for better system performance.", "Improved application accessibility and responsiveness."] },
        { "title": "Pro Line Fusion", "duration": "Feb 2016 â€“ Mar 2018", "technologies": ["AngularJS", "JavaScript", "HTML", "CSS", "C#", "ASP.NET MVC", "SQL Server"], "client": "Rockwell Collins", "description": "Worked on avionics display systems with AngularJS-based UI and backend APIs in C# ASP.NET MVC, focusing on real-time data visualization.", "responsibilities": ["Developed AngularJS components for avionics dashboards.", "Built backend modules in C# ASP.NET MVC.", "Ensured real-time data updates using optimized APIs.", "Collaborated with QA team for rigorous testing cycles.", "Participated in Agile ceremonies and sprint planning."] },
        { "title": "Kantar Analytics", "duration": "Dec 2013 â€“ Jul 2015", "technologies": ["C#", "ASP.NET", "ADO.NET", "SQL Server"], "client": "Kantar GDC", "description": "Developed and maintained analytics dashboards for client reporting, optimizing SQL queries and improving system performance.", "responsibilities": ["Created ASP.NET web forms for reporting dashboards.", "Implemented ADO.NET for data access and manipulation.", "Improved SQL queries and stored procedures for faster results.", "Supported clients by troubleshooting and resolving issues.", "Documented technical workflows for internal teams."] }
      ],
      "education": [{ "degree": "Bachelor of Technology (B.Tech)", "field": "Computer Science and Engineering", "university": "Uttar Pradesh Technical University", "year_of_passing": "2013" }],
      "languages": [{ "language": "English", "proficiency": "Professional" }, { "language": "Hindi", "proficiency": "Native" }],
      "personal_information": { "date_of_birth": "", "gender": "Male", "marital_status": "", "nationality": "Indian", "hobbies": ["Reading Tech Blogs", "Problem Solving", "Cricket"] }
    };

    const editor = document.getElementById('jsonEditor');
    const jsonPreview = document.getElementById('jsonPreview');
    const errorEl = document.getElementById('error');
    const fileInput = document.getElementById('fileInput');

    function setEditor(obj) {
      editor && (editor.value = JSON.stringify(obj, null, 2));
      errorEl && (errorEl.textContent = '');
    }

    function showError(msg) { errorEl.textContent = msg; }

    function parseEditor() {
      try {
        const v = editor.value.trim();
        if (!v) throw new Error('Editor is empty');
        const obj = JSON.parse(v);
        errorEl.textContent = '';
        return obj;
      } catch (err) { showError('Invalid JSON: ' + err.message); return null; }
    }

    // Renderer (same as before)
    const $ = (tag, props = {}, ...children) => {
      const el = document.createElement(tag);
      for (const [k, v] of Object.entries(props || {})) {
        if (k === 'class') el.className = v;
        else if (k === 'html') el.innerHTML = v;
        else if (k.startsWith('on') && typeof v === 'function') el[k.toLowerCase()] = v;
        else el.setAttribute(k, v);
      }
      for (const c of children.flat()) {
        if (c == null) continue;
        el.appendChild(typeof c === 'string' ? document.createTextNode(c) : c);
      }
      return el;
    };

    function renderContact(c) {
      const parts = [];
      if (c?.website) parts.push($('div', {}, $('a', { href: c.website, target: '_blank' }, c.website)));
      if (c?.email) parts.push($('div', {}, $('a', { href: `mailto:${c.email}` }, c.email)));
      if (c?.phone) parts.push($('div', {}, $('a', { href: `tel:${c.phone}` }, c.phone)));
      const addr = c?.address || {};
      const addrStr = [addr.street, addr.city, addr.state, addr.zip].filter(Boolean).join(', ');
      if (addrStr) parts.push($('div', { class: 'muted' }, addrStr));
      return $('div', { class: 'contact' }, parts);
    }

    function renderResume(obj) {
      if (!obj) return;
      jsonPreview && (jsonPreview.innerHTML = '');
      const fullName = [obj?.name?.first, obj?.name?.last].filter(Boolean).join(' ');
      const header = $('header', {}, $('div', {}, $('div', { class: 'name' }, fullName)), renderContact(obj.contact));
      jsonPreview && jsonPreview.appendChild($('div', { class: 'page' }, header));

      if (obj.summary?.length) {
        const sec = $('section', { class: 'section summary' }, $('h2', {}, 'Summary'));
        obj.summary.forEach(p => sec.appendChild($('p', {}, p)));
        jsonPreview && jsonPreview.querySelector('.page').appendChild(sec);
      }

      if (obj.career_summary?.length) {
        const sec = $('section', { class: 'section career' }, $('h2', {}, 'Career Summary'));
        obj.career_summary.forEach(j => {
          const job = $('div', { class: 'job' });
          job.appendChild($('div', { class: 'row' }, $('div', { class: 'role' }, j.role || ''), j.company ? $('div', { class: 'company' }, ` ${j.company}`) : null, j.location ? $('div', { class: 'location' }, ` ${j.location}`) : null, j.duration ? $('div', { class: 'duration' }, ` ${j.duration}`) : null));
          if (j.description) job.appendChild($('p', {}, j.description));
          sec.appendChild(job);
        });
        jsonPreview && jsonPreview.querySelector('.page').appendChild(sec);
      }

      if (obj.skills?.length) {
        const sec = $('section', { class: 'section skills' }, $('h2', {}, 'Skills'), $('div', {}, ...obj.skills.map(s => $('span', { class: 'chip' }, s))));
        jsonPreview && jsonPreview.querySelector('.page').appendChild(sec);
      }

      if (obj.projects?.length) {
        const sec = $('section', { class: 'section projects' }, $('h2', {}, 'Projects'));
        obj.projects.forEach(p => {
          const pr = $('div', { class: 'project' });
          pr.appendChild($('div', { class: 'row' }, $('div', { class: 'role' }, p.title || ''), p.client ? $('div', { class: 'company' }, ` ${p.client}`) : null, p.duration ? $('div', { class: 'duration' }, ` ${p.duration}`) : null));
          if (p.technologies?.length) pr.appendChild($('div', { class: 'muted' }, `Tech: ${p.technologies.join(', ')}`));
          if (p.description) pr.appendChild($('p', {}, p.description));
          if (p.responsibilities?.length) pr.appendChild($('ul', { class: 'resp' }, ...p.responsibilities.map(r => $('li', {}, r))));
          sec.appendChild(pr);
        });
        jsonPreview && jsonPreview.querySelector('.page').appendChild(sec);
      }

      if (obj.education?.length) {
        const sec = $('section', { class: 'section education' }, $('h2', {}, 'Education'));
        obj.education.forEach(e => sec.appendChild($('div', { class: 'edu-item' }, $('div', { class: 'row' }, $('div', { class: 'role' }, e.degree || ''), e.field ? $('div', { class: 'company' }, ` ${e.field}`) : null, e.university ? $('div', { class: 'location' }, ` ${e.university}`) : null, e.year_of_passing ? $('div', { class: 'duration' }, ` ${e.year_of_passing}`) : null))));
        jsonPreview && jsonPreview.querySelector('.page').appendChild(sec);
      }

      if (obj.languages?.length) {
        const sec = $('section', { class: 'section languages' }, $('h2', {}, 'Languages'), $('table', { class: 'lang-table' }, ...obj.languages.map(l => $('tr', {}, $('td', {}, l.language || ''), $('td', {}, $('span', { class: 'badge' }, l.proficiency || ''))))));
        jsonPreview && jsonPreview.querySelector('.page').appendChild(sec);
      }

      if (obj.personal_information) {
        const sec = $('section', { class: 'section personal' }, $('h2', {}, 'Personal Information'));
        const info = obj.personal_information;
        if (info.date_of_birth) sec.appendChild($('p', {}, $('strong', {}, 'Date of birth: '), info.date_of_birth));
        if (info.gender) sec.appendChild($('p', {}, $('strong', {}, 'Gender: '), info.gender));
        if (info.marital_status) sec.appendChild($('p', {}, $('strong', {}, 'Marital status: '), info.marital_status));
        if (info.nationality) sec.appendChild($('p', {}, $('strong', {}, 'Nationality: '), info.nationality));
        if (info.hobbies?.length) sec.appendChild($('p', {}, $('strong', {}, 'Hobbies: '), info.hobbies.join(', ')));
        jsonPreview && jsonPreview.querySelector('.page').appendChild(sec);
      }

      // jsonPreview && jsonPreview.querySelector('.page').appendChild($('footer',{}, 'Generated from JSON'));
    }

    // Controls
    document.getElementById('btnRender') && document.getElementById('btnRender').addEventListener('click', () => {
      const obj = parseEditor(); if (obj) renderResume(obj);
    });

    document.getElementById('btnFormat') && document.getElementById('btnFormat').addEventListener('click', () => {
      const obj = parseEditor(); if (!obj) return; editor.value = JSON.stringify(obj, null, 2);
    });

    document.getElementById('btnMinify') && document.getElementById('btnMinify').addEventListener('click', () => {
      const obj = parseEditor(); if (!obj) return; editor.value = JSON.stringify(obj);
    });

    document.getElementById('btnReset') && document.getElementById('btnReset').addEventListener('click', () => { setEditor(sample); renderResume(sample); });

    document.getElementById('btnDownload') && document.getElementById('btnDownload').addEventListener('click', () => {
      const v = editor.value; if (!v) return showError('Editor is empty');
      const blob = new Blob([v], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'resume.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    fileInput && fileInput.addEventListener('change', (e) => {
      const f = e.target.files && e.target.files[0]; if (!f) return;
      const reader = new FileReader();
      reader.onload = () => { editor.value = reader.result; errorEl.textContent = ''; };
      reader.onerror = () => showError('Failed to read file');
      reader.readAsText(f);
      fileInput.value = '';
    });

    // initialize
    setEditor(sample);
    renderResume(sample);
    document.getElementById("btnPrintPreview").addEventListener("click", () => {
      const preview = document.getElementById("jsonPreview");

      if (!preview || !preview.innerHTML.trim()) {
        alert("Nothing to print! Please render the resume first.");
        return;
      }

      const w = window.open("", "_blank");
      const html = `
      <!doctype html>
      <html>
      <head>
        <meta charset="utf-8">
        <title>Resume Preview</title>
        <link rel="stylesheet" href="./style/jsonToHtml.css">
        <link rel="stylesheet" href="./style/bcv.css">
        <style>
          body { font-family: Arial, sans-serif; margin: 40px; color: #111; }
          h2 { border-bottom: 1px solid #ccc; padding-bottom: 4px; }
          .chip { display:inline-block; padding:4px 8px; margin:3px; border:1px solid #ddd; border-radius:999px; font-size:12px; }
        </style>
      </head>
      <body>
        ${preview.innerHTML}
      </body>
      </html>
    `;

      w.document.write(html);
      w.document.close();
      w.focus();
      setTimeout(() => w.print(), 300);
    });
  </script>
  <script>
    function openPopup() {
      document.getElementById("popupOverlay").style.display = "flex";
    }

    function closePopup() {
      document.getElementById("popupOverlay").style.display = "none";
    }
  </script>
  <script>
    function convertJSON(inputJSON) {
      try {
        const input = inputJSON;

        // Split name
        const [first, last] = input.name.split(" ");

        // Build target JSON
        const output = {
          name: {
            first: first || "",
            last: last || ""
          },
          contact: {
            phone: input.phone || "",
            email: input.email || "",
            website: "https://www.buildcv.co.in/",
            address: {
              street: "",
              city: "",
              state: "",
              zip: ""
            }
          },
          summary: input.summary ? input.summary.split("\n").filter(s => s.trim() !== "") : [],
          career_summary: input.experience
            ? input.experience.map(exp => ({
              role: exp.role || "",
              company: exp.company || "",
              location: "",
              duration: `${exp.from} to ${exp.to}`,
              description: exp.desc || ""
            }))
            : [],
          skills: input.skills || [],
          projects: input.experience
            ? input.experience.map(exp => ({
              title: exp.desc.split("\n")[0] || "",
              duration: `${exp.from} â€“ ${exp.to}`,
              technologies: ["React.JS", "JavaScript", "HTML", "CSS"], // You can refine this parsing
              client: exp.company || "",
              description: exp.desc.split("\n")[3] || "",
              responsibilities: exp.desc.split("\n").slice(4).filter(s => s.trim() !== "")
            }))
            : [],
          education: input.education
            ? input.education.map(ed => ({
              degree: ed.degree || "",
              field: ed.school || "",
              university: ed.school || "",
              year_of_passing: ed.year || "",
              grade: ed.grade || ""
            }))
            : [],
          languages: input.languages
            ? input.languages.map(lang => ({
              language: lang,
              proficiency: lang === "English" ? "Professional" : (lang === "Hindi" ? "Native" : "Intermediate")
            }))
            : [],
          personal_information: {
            date_of_birth: input.personalInformation || "",
            gender: "Male",
            marital_status: "",
            nationality: "Indian",
            hobbies: ["Reading Tech Blogs", "Problem Solving", "Cricket"]
          }
        };

        return output;

        // document.getElementById("outputJson").value = JSON.stringify(output, null, 2);
      } catch (e) {
        alert("Invalid JSON input: " + e.message);
      }
    }
  </script>
  
<script>
    function generatePDF(cvPreviewId = 'preview') {
        // Ensure the preview is up-to-date if it's the main editor.
        if (cvPreviewId === 'preview') {
            renderPreview();
        }else {
            renderResume(parseEditor());
        }

        const sourceElement = document.getElementById(cvPreviewId);
        if (!sourceElement || !sourceElement.innerHTML.trim()) {
            alert("Nothing to download! Please render the resume first.");
            return;
        }

        // 1. Create a hidden iframe.
        const printFrame = document.createElement('iframe');
        printFrame.style.cssText = 'position:absolute; width:0; height:0; border:0; left:-9999px;';
        document.body.appendChild(printFrame);

        const contentHTML = sourceElement.innerHTML;

        // 2. Prepare the HTML using the reliable table-header spacer method.
        const frameDoc = `
            <!DOCTYPE html>
            <html>
            <head>
                <title>Resume</title>
                <link rel="stylesheet" href="./style/jsonToHtml.css">
                <link rel="stylesheet" href="./style/bcv.css">
                <style>
                    /* This rule remains essential for removing browser headers/footers */
                    @page {
                        size: A4;
                        margin: 0;
                    }

                    @media print {
                        html, body {
                           margin: 0;
                           padding: 0;
                        }

                        /* This is the repeating spacer. It acts as our top margin. */
                        .page-spacer {
                            height: 20mm; /* <-- YOUR TOP MARGIN. ADJUST AS NEEDED. */
                        }

                        /* This magic CSS rule tells the browser to repeat the <thead> on every new page. */
                        thead {
                            display: table-header-group;
                        }
                        
                        /* This ensures the table itself doesn't add unwanted borders or spacing. */
                        table {
                            width: 100%;
                            border-collapse: collapse;
                        }

                        /* Apply left/right margins to the overall content container */
                        .content-cell {
                            padding-left: 15mm;
                            padding-right: 15mm;
                            padding-bottom: 20mm; /* Bottom margin for content */
                        }
                    }
                </style>
            </head>
            <body>
                <!-- This table structure is the key to the fix -->
                <table>
                    <!-- This empty header will repeat on every page, creating the top margin -->
                    <thead>
                        <tr>
                            <td class="page-spacer"></td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="content-cell">
                                <!-- Your actual resume content goes here -->
                                ${contentHTML}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </body>
            </html>
        `;

        // 3. Write the HTML to the iframe.
        const frameWindow = printFrame.contentWindow;
        frameWindow.document.open();
        frameWindow.document.write(frameDoc);
        frameWindow.document.close();

        // 4. Trigger the print dialog and clean up.
        setTimeout(() => {
            try {
                frameWindow.focus();
                frameWindow.print();
            } catch (error) {
                console.error("Failed to open print dialog:", error);
            } finally {
                document.body.removeChild(printFrame);
            }
        }, 500);
    }
</script>
</body>


</html>